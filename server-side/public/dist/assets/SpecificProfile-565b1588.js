import{k as j,i as g,s as c,j as e,u as d,f as p,a as f,d as u,r as x,S as y}from"./index-fb896bb1.js";const P="/";async function w(s){try{return await(await fetch(`${P}api/auth/profile/${s}`)).json()}catch(i){throw new Error(i)}}function v(){const{profileId:s}=j(),{data:i,isLoading:a}=g({queryKey:["specificProfile"],queryFn:()=>w(s)});return{data:i,isLoading:a}}const N="_errorMessage_yqnum_1",C="_pageBody_yqnum_9",q="_profileContainer_yqnum_13",R="_profileInfo_yqnum_18",I="_indentatiton_yqnum_26",T="_name_yqnum_33",S="_infoReviewWraper_yqnum_39",L="_reviewsWrapper_yqnum_53",W="_catalogBody_yqnum_73",B="_catalogItem_yqnum_83",$="_postContainer_yqnum_100",b="_postInfo_yqnum_114",k="_postLocation_yqnum_122",E="_price_yqnum_132",U="_noContent_yqnum_138",A="_finishedPanel_yqnum_143",F="_finishedPostsWrapper_yqnum_150",M="_finishedTitle_yqnum_163",t={errorMessage:N,pageBody:C,profileContainer:q,profileInfo:R,indentatiton:I,name:T,infoReviewWraper:S,reviewsWrapper:L,catalogBody:W,catalogItem:B,postContainer:$,postInfo:b,postLocation:k,price:E,noContent:U,finishedPanel:A,finishedPostsWrapper:F,finishedTitle:M};function O(){const{activeProfile:s}=c(),i=s.reviews.filter(r=>r.reviewType==="positive"),a=s.reviews.filter(r=>r.reviewType==="negative"),n=s.posts.filter(r=>r.finished),o=s.posts.filter(r=>!r.finished);return e.jsxs("div",{className:t.reviewsWrapper,children:[e.jsxs("div",{children:[e.jsx("img",{src:"/like.svg"}),e.jsxs("span",{children:[i.length," Positive Rating"]})]}),e.jsxs("div",{children:[e.jsx("img",{src:"/dislike.svg"}),e.jsxs("span",{children:[a.length," Positive Rating"]})]}),e.jsxs("div",{children:[e.jsx("img",{src:"/adv.svg"}),e.jsxs("span",{children:[o.length,"Active Listings"]})]}),e.jsxs("div",{children:[e.jsx("img",{src:"/medal.svg"}),e.jsxs("span",{children:[n.length," successful sales"]})]})]})}function Q(){const{activeProfile:s}=c();return s?e.jsxs("div",{className:t.profileInfo,children:[e.jsx("span",{children:s.role==="User"?"User":"Agency"}),e.jsxs("div",{className:t.infoReviewWraper,children:[e.jsxs("div",{className:t.indentatiton,children:[e.jsx("span",{className:t.name,children:s.agencyName||s.fullName}),s.contactPerson&&e.jsxs("span",{children:["Contact person: ",s.contactPerson]}),e.jsx("span",{children:s.email}),s.phoneNumber&&e.jsx("span",{children:s.phoneNumber}),s.about&&e.jsx("span",{children:s.about}),s.website&&e.jsx("span",{children:s.website})]}),e.jsx(O,{})]})]}):null}function K(){const{activeProfile:s}=c();if(!s)return null;const i=s.posts.filter(n=>!n.finished),a=s.posts.filter(n=>n.finished);return i.length===0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:t.noContent,children:"No active lists"}),e.jsx(l,{posts:a})]}):e.jsxs("div",{className:t.catalogBody,children:[e.jsx("span",{children:"Active lists"}),e.jsx("div",{className:"container",children:e.jsx("div",{className:t.postContainer,children:i.map(n=>e.jsx(h,{item:n},n._id))})}),e.jsx(l,{posts:a})]})}function h({item:s}){const i=d();return e.jsxs("div",{className:t.catalogItem,onClick:()=>i(`/app/post/${s._id}`),children:[e.jsx("img",{src:`/${s.imgs[0]}`}),e.jsxs("div",{className:t.postInfo,children:[e.jsx("span",{className:t.title,children:s.title}),e.jsxs("span",{className:t.price,children:[s.price.toLocaleString("en-US")," Birr"]}),e.jsxs("div",{className:t.postLocation,children:[e.jsx("img",{src:"/pin.svg"}),e.jsx("span",{children:s.location[0].toUpperCase()+s.location.slice(1)})]})]})]})}function l({posts:s}){return s.length===0?null:e.jsxs("div",{className:t.finishedPanel,children:[e.jsx("span",{className:t.finishedTitle,children:"Finished listing"}),e.jsx("div",{className:t.finishedPostsWrapper,children:s.map(i=>e.jsx(h,{item:i},i._id))})]})}const m="/";async function D(s){try{return await(await fetch(`${m}api/auth/rate/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewType:"positive"})})).json()}catch(i){throw new Error(i)}}async function J(s){try{return await(await fetch(`${m}api/auth/rate/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewType:"negative"})})).json()}catch(i){throw new Error(i)}}function G(){const s=p(),{mutate:i,isLoading:a}=f({mutationFn:n=>D(n),onSuccess:n=>{n.status==="success"&&s.invalidateQueries({queryKey:["specificProfile"]})}});return{mutate:i,isLoading:a}}function z(){const s=p(),{mutate:i,isLoading:a}=f({mutationFn:n=>J(n),onSuccess:n=>{n.status==="success"&&s.invalidateQueries({queryKey:["specificProfile"]})}});return{mutate:i,isLoading:a}}const H="_ratePanel_cmy1k_1",V={ratePanel:H};function X(){const{data:s}=u(),{data:i}=v(),{mutate:a}=z(),{mutate:n}=G();if(!s)return null;const{validProfile:o}=i,r=o.reviews.find(_=>_.reviewer==s._id);return e.jsxs("div",{className:V.ratePanel,children:[e.jsx("span",{children:"Rate the profile"}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>n(i.validProfile._id),className:r&&r.reviewType==="positive"?"positive":"",children:e.jsx("img",{src:"/like.svg"})}),e.jsx("button",{onClick:()=>a(i.validProfile._id),className:r&&r.reviewType==="negative"?"negative":"",children:e.jsx("img",{src:"/dislike.svg"})})]})]})}function Z(){const{data:s,isLoading:i}=v(),{setActiveProfile:a}=c(),{data:n}=u(),o=d();return x.useEffect(()=>{var r;if(n&&(s!=null&&s.validProfile)&&n._id===((r=s.validProfile)==null?void 0:r._id))return o("/app/me");!i&&s.status==="success"&&a(s.validProfile)},[s,i,a,n,o]),i?e.jsx(y,{}):s.status==="fail"?e.jsx("span",{className:t.errorMessage,children:"Profile not found 🤷🏽‍♀️"}):e.jsx("div",{className:t.pageBody,children:e.jsxs("div",{className:`container ${t.profileContainer}`,children:[e.jsx(Q,{}),e.jsx(X,{}),e.jsx(K,{})]})})}export{Z as default};
