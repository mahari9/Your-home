import{u as b,a as f,n as d,j as e,S as h,L as w,r as S}from"./index-d279e8cb.js";import{u as N,L as v}from"./index.esm-ee852ab0.js";import{s as F,R as _}from"./ReturnButton-4b904f32.js";import{u as k}from"./usePreventAccess-4e04a38e.js";const A="_interfaceWrapper_11k4u_1",E="_pickModal_11k4u_17",P="_registerForm_11k4u_87",L="_headingWrapper_11k4u_154",W="_textareaWrapper_11k4u_158",t={interfaceWrapper:A,pickModal:E,registerForm:P,headingWrapper:L,textareaWrapper:W},C="/";async function q(s){s.phoneNumber===""?s.phoneNumber=void 0:s.phoneNumber;try{return await(await fetch(`${C}api/auth/user/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}catch(n){throw new Error(n)}}async function M(s){s.phoneNumber===""?s.phoneNumber=void 0:s.phoneNumber;try{return await(await fetch(`${C}api/auth/agency/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}catch(n){throw new Error(n)}}function T(){const s=b(),{mutate:n,isLoading:r}=f({mutationFn:a=>q(a),onSuccess:a=>{a.status==="success"&&(F(a.token),d.success(a.message),s("/app")),a.status==="fail"&&d.error(a.message)},onError:a=>d.error(a.message)});return{mutate:n,isLoading:r}}function U(){var i,o,c,l;const{register:s,handleSubmit:n,formState:{errors:r}}=N(),{mutate:a,isLoading:m}=T();return m?e.jsx(h,{}):e.jsxs("form",{className:t.registerForm,onSubmit:n(p=>a(p)),children:[e.jsxs("div",{className:t.headingWrapper,children:[e.jsx("h2",{children:"Registration"}),e.jsx("h3",{children:"Fill in your personal information"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",children:"First and Last Name"}),e.jsx("input",{type:"text",placeholder:"Mahari Tsegay",...s("fullName",{required:"Enter your first and last name"})}),((i=r.fullName)==null?void 0:i.message)&&e.jsxs("span",{children:[r.fullName.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"Email adress"}),e.jsx("input",{type:"email",placeholder:"example@gmail.com",...s("email",{required:"Enter your email!"})}),((o=r.email)==null?void 0:o.message)&&e.jsxs("span",{children:[r.email.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",children:"Residence location"}),e.jsx(v,{register:s})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",placeholder:"*********",...s("password",{required:"Enter your password"})}),((c=r.password)==null?void 0:c.message)&&e.jsxs("span",{children:[r.password.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone number"}),e.jsx("input",{type:"number",placeholder:"+251944779932",...s("phoneNumber")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passwordConfirm",children:"Repeat the password"}),e.jsx("input",{type:"password",placeholder:"********",...s("passwordConfirm",{required:"Repeat the password!"})}),((l=r.passwordConfirm)==null?void 0:l.message)&&e.jsxs("span",{children:[r.passwordConfirm.message," "]})]}),e.jsxs("span",{children:["Do you already have an existing account? ",e.jsx(w,{to:"/login",children:"Log in"})]}),e.jsx("button",{children:"Register"})]})}function O(){const s=b(),{mutate:n,isLoading:r}=f({mutationFn:a=>M(a),onSuccess:a=>{a.status==="success"&&(F(a.token),d.success(a.message),s("/app")),a.status==="fail"&&d.error(a.message)}});return{mutate:n,isLoading:r}}function Y(){var i,o,c,l,p,u,x,g,j,y;const{register:s,handleSubmit:n,formState:{errors:r}}=N(),{mutate:a,isLoading:m}=O();return m?e.jsx(h,{}):e.jsxs("form",{className:t.registerForm,onSubmit:n(R=>a(R)),children:[e.jsxs("div",{className:t.headingWrapper,children:[e.jsx("h2",{children:"Agency registration"}),e.jsx("h3",{children:"Complete the information"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"agencyName",children:"Agency name*"}),e.jsx("input",{type:"text",placeholder:"Newc Agency",name:"agencyName",id:"agencyName",...s("agencyName",{required:"Enter the name of the agency"})}),((i=r.agencyName)==null?void 0:i.message)&&e.jsx("span",{children:(o=r.agencyName)==null?void 0:o.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"contactPerson",children:"Contact person"}),e.jsx("input",{type:"text",placeholder:"Newc contact",name:"contactPerson",id:"contactPerson",...s("contactPerson",{required:"Enter the name of the contact person"})}),((c=r.contactPerson)==null?void 0:c.message)&&e.jsx("span",{children:(l=r.contactPerson)==null?void 0:l.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"Email adress of your agency"}),e.jsx("input",{type:"email",placeholder:"example@gmail.com",name:"email",id:"email",...s("email",{required:"Enter the agency’s email"})}),((p=r.email)==null?void 0:p.message)&&e.jsx("span",{children:(u=r.email)==null?void 0:u.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",children:"Agency location*"}),e.jsx(v,{register:s})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",placeholder:"Your password",name:"password",id:"password",...s("password",{required:"Enter password"})}),((x=r.password)==null?void 0:x.message)&&e.jsx("span",{children:(g=r.password)==null?void 0:g.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Agency’s phone numbere"}),e.jsx("input",{type:"number",placeholder:"Your phone",name:"phoneNumber",id:"phoneNumber",...s("phoneNumber")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passwordConfirm",children:"Repeat the password"}),e.jsx("input",{type:"password",placeholder:"Confirm Your password*",name:"passwordConfirm",id:"passwordConfirm",...s("passwordConfirm",{required:"Repeat the password"})}),((j=r.passwordConfirm)==null?void 0:j.message)&&e.jsx("span",{children:(y=r.passwordConfirm)==null?void 0:y.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",children:"`Agency’s website`"}),e.jsx("input",{type:"text",placeholder:"Your website address",name:"website",id:"website",...s("website")})]}),e.jsxs("div",{className:t.textareaWrapper,children:[e.jsx("label",{htmlFor:"about",children:"About the Agency"}),e.jsx("textarea",{name:"about",id:"about",...s("about")})]}),e.jsxs("span",{children:["Do you already have an existing account? ",e.jsx(w,{to:"/login",children:"Log in"})]}),e.jsx("button",{children:"Register"})]})}function G(){const s=k(),[n,r]=S.useState(null);return s?e.jsx(h,{}):e.jsxs("div",{className:t.interfaceWrapper,children:[e.jsx(_,{}),!n&&e.jsxs("div",{className:t.pickModal,children:[e.jsx("span",{children:"Register as"}),e.jsxs("div",{onClick:()=>r("agency"),children:[e.jsx("span",{children:"Agency"}),e.jsx("img",{src:"/agent.svg",alt:"agency briefcase"})]}),e.jsxs("div",{onClick:()=>r("user"),children:[e.jsx("span",{children:"User"}),e.jsx("img",{src:"/user.svg",alt:"user icon"})]})]}),n==="user"&&e.jsx(U,{}),n==="agency"&&e.jsx(Y,{})]})}export{G as default};
